<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Radio Only Haswer</title>
<style>
body{margin:0;background:#0b0b0b;color:#fff;font-family:Arial;text-align:center;overflow-x:hidden;}
.bg{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 20%, #1f1f1f, #000);animation:bgmove 12s infinite alternate;z-index:-1;}
@keyframes bgmove{0%{background-position:0 0}100%{background-position:100px 200px}}
header{padding:25px;font-size:32px;font-weight:bold;background:#111;box-shadow:0 2px 20px #000;letter-spacing:1px;}
nav{margin-top:10px;display:flex;justify-content:center;gap:20px;}
nav a{color:#4ade80;font-size:18px;cursor:pointer;text-decoration:none;padding:8px 14px;border-radius:8px;transition:.2s;}
nav a:hover{background:#222;}
.section{display:none;padding:25px;animation:fade .4s;}
@keyframes fade{from{opacity:0}to{opacity:1}}
.player{max-width:450px;margin:20px auto;background:#1b1b1b;padding:25px;border-radius:18px;box-shadow:0 0 20px #000;}
audio{width:100%;margin-top:15px;}
#viz{width:100%;height:80px;margin-top:15px;background:linear-gradient(to right,#333,#111);border-radius:10px;}
.meta{margin-top:15px;color:#4ade80;font-size:18px;}
.social{margin-top:20px;display:flex;justify-content:center;gap:20px;}
.social a{color:#fff;font-size:24px;text-decoration:none;}
footer{margin:40px 0;color:#777;font-size:14px;}
.chatbox{display:flex;justify-content:center;margin-top:20px;}
</style>
</head>
<body>

<div class="bg"></div>
<header>üìª Radio Only Haswer</header>
<nav>
<a onclick="show('radio')">Radio</a>
<a onclick="show('chat')">Chat</a>
<a onclick="show('info')">Info</a>
</nav>

<!-- RADIO -->
<div id="radio" class="section" style="display:block">
  <div class="player">
    <img src="https://cdn-icons-png.flaticon.com/512/727/727245.png" width="90" alt="logo">
    <audio id="audio" controls></audio>
    <canvas id="viz"></canvas>
    <div id="meta" class="meta">Cargando metadata...</div>
    <div id="listeners" style="margin-top:8px;color:#aaa;font-size:14px"></div>
    <div class="social">
      <a href="#">üåê</a>
      <a href="#">üìò</a>
      <a href="#">‚ñ∂Ô∏è</a>
      <a href="#">üì∏</a>
    </div>
  </div>
</div>

<!-- CHAT -->
<div id="chat" class="section">
  <div class="section-title">üí¨ Chat en vivo</div>
  <div class="chatbox">
    <iframe src="https://xat.com/embed/chat.php#id=5&gn=OnlyHaswerRadio"
            width="900" height="600"></iframe>
  </div>
</div>

<!-- INFO -->
<div id="info" class="section">
<h2>‚ÑπÔ∏è Informaci√≥n</h2>
<p>Radio Only Haswer ‚Äî Transmitiendo 24/7 con Icecast + BUTT.</p>
<p>Versi√≥n completa del sitio con player, visualizador, chat, tabs y estilo oscuro.</p>
</div>

<footer>Radio Only Haswer ‚Äî GitHub Pages</footer>

<script src="config.js"></script>
<script>
function show(id){
  document.querySelectorAll('.section').forEach(s=>s.style.display='none');
  document.getElementById(id).style.display='block';
}
const NGROK_URL = "https://oblanceolate-preapply-oneida.ngrok-free.dev";
  
// Configurar audio y metadata
const audio = document.getElementById("audio");
audio.src = "https://corsproxy.io/?" + encodeURIComponent(NGROK_URL + "/radio.mp3");
audio.play().catch(()=>{}); // autoplay puede bloquearse en algunos navegadores

const metaUrl = "https://corsproxy.io/?" + encodeURIComponent(NGROK_URL + "/status-json.xsl");

// Visualizador
const ctx = new (window.AudioContext || window.webkitAudioContext)();
const src = ctx.createMediaElementSource(audio);
const analyser = ctx.createAnalyser();
src.connect(analyser);
analyser.connect(ctx.destination);
analyser.fftSize = 256;
const buffer = new Uint8Array(analyser.frequencyBinCount);
const canvas = document.getElementById("viz");
const c = canvas.getContext("2d");
function drawViz(){
  requestAnimationFrame(drawViz);
  analyser.getByteFrequencyData(buffer);
  c.fillStyle="#111";
  c.fillRect(0,0,canvas.width,canvas.height);
  let barWidth=canvas.width/buffer.length;
  for(let i=0;i<buffer.length;i++){
    const h=buffer[i];
    c.fillStyle="#4ade80";
    c.fillRect(i*barWidth,canvas.height-h,barWidth-1,h);
  }
}
canvas.width=450;
drawViz();

// Metadata en vivo
async function loadMeta(){
  try{
    const r = await fetch(metaUrl);
    const j = await r.json();
    let srcData = j.icestats.source;
    if(Array.isArray(srcData)) srcData = srcData.find(s=>s.listenurl.includes("radio.mp3"));
    document.getElementById("meta").innerText="‚ñ∂ "+(srcData.title||"Sin metadata");
    document.getElementById("listeners").innerText="üë• Oyentes: "+(srcData.listeners||0);
  }catch(e){
    document.getElementById("meta").innerText="Metadata no disponible";
    document.getElementById("listeners").innerText="";
  }
}
loadMeta();
setInterval(loadMeta,10000);
</script>

</body>
</html>





