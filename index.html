<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>OnlyHaswer Radio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        background: #0a0a0a;
        color: #0f0;
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        padding: 0;
    }

    h1 {
        padding-top: 20px;
        text-shadow: 0 0 10px #0f0;
    }

    #visualizer {
        width: 100%;
        height: 180px;
        background: #000;
    }

    /* Metadata */
    #metadata {
        margin-top: 10px;
        font-size: 18px;
        text-shadow: 0 0 8px #0f0;
    }

    /* BotÃ³n Play/Pause flotante */
    #playBtn {
        position: fixed;
        bottom: 15px;
        right: 15px;
        width: 70px;
        height: 70px;
        border-radius: 50%;
        border: none;
        background: #0f0;
        color: black;
        font-size: 32px;
        font-weight: bold;
        box-shadow: 0 0 15px #0f0;
        cursor: pointer;
        z-index: 999;
    }

    @media (min-width: 700px) {
        #playBtn {
            bottom: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
        }
    }
</style>
</head>
<body>

<h1>ðŸ“» OnlyHaswer Radio</h1>

<canvas id="visualizer"></canvas>
<div id="metadata">ðŸ“¡ Cargando seÃ±al...</div>

<button id="playBtn">â–¶</button>

<audio id="radio" preload="none" crossorigin="anonymous">
    <source src="http://uk26freenew.listen2myradio.com:5838/stream" type="audio/mpeg">
</audio>

<script>
const audio = document.getElementById('radio');
const playBtn = document.getElementById('playBtn');
const metadataDiv = document.getElementById('metadata');

// Play/Pause
playBtn.addEventListener('click', () => {
    if (audio.paused) {
        audio.play();
        playBtn.textContent = "â¸";
    } else {
        audio.pause();
        playBtn.textContent = "â–¶";
    }
});

// Visualizador
const canvas = document.getElementById('visualizer');
const ctx = canvas.getContext('2d');
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
const analyser = audioCtx.createAnalyser();

audio.addEventListener("play", () => {
    const source = audioCtx.createMediaElementSource(audio);
    source.connect(analyser);
    analyser.connect(audioCtx.destination);
    visualize();
});

function visualize() {
    analyser.fftSize = 256;
    const bufferLength = analyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);

    function draw() {
        requestAnimationFrame(draw);
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        analyser.getByteFrequencyData(dataArray);

        const barWidth = (canvas.width / bufferLength);
        let x = 0;

        for (let i = 0; i < bufferLength; i++) {
            const barHeight = dataArray[i] / 1.3;
            ctx.fillStyle = "#0f0";
            ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
            x += barWidth;
        }
    }
    draw();
}

// Metadata fetch (si el servidor la expone)
function checkMetadata() {
    fetch("http://uk26freenew.listen2myradio.com:5838/stream", {
        method: "GET",
        mode: "no-cors"
    })
    .then(() => {
        metadataDiv.textContent = "ðŸ”Š En vivo - OnlyHaswer Radio";
    })
    .catch(() => {
        metadataDiv.textContent = "ðŸŽ¶ Reproduciendo...";
    });
}

setInterval(checkMetadata, 8000);
</script>

</body>
</html>


